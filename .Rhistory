basin %in% c("LEWI", "WIND", "COWL") ~ "L_Columbia_R_sp",
basin == "GHLC" ~ "Washington_Coast",
rmis_region %in% c("WILP", "NWC") ~ "Washington_Coast",
rmis_region == "HOOD" ~ "Hood_Canal",
rmis_region == "JUAN" ~ "Juan_de_Fuca",
rmis_region == "MPS" ~ "C_Puget_Sound",
rmis_region %in% c("NPS", "NOWA", "SKAG") ~ "N_Puget_Sound",
rmis_region == "SPS" ~ "S_Puget_Sound",
TRUE ~ Region1Name
)
)
key2 <- rbind(key1,
cwt_out %>%
select(stock, Region1Name)) %>%
mutate(Region1Name = gsub(" ", "_", Region1Name))
key_out <- key2 %>%
left_join(.,
key_rts %>%
select(Region1Name, Region2Name, Region3Name) %>%
distinct(),
by = "Region1Name") %>%
distinct() %>%
mutate(
Region2Name =
case_when(
Region1Name %in% c("Nass", "Skeena_Lower", "Skeena_Bulkley",
"Skeena_Mid", "Skeena_Upper", "Skeena_Babine",
"Alsek") ~ "North/Central BC",
grepl("Fraser_Spring", Region1Name) ~ "Fraser Early",
grepl("Fraser_Summer", Region1Name) ~ "Fraser Early",
grepl("Fraser_Fall", Region1Name) ~ "Fraser Late",
Region1Name == "Juan_de_Fuca" ~ "Washington Coast/Juan de Fuca",
Region1Name == "Hood_Canal" ~ "Hood Canal",
Region1Name == "Central_Valley_fa" ~ "California",
Region1Name == "Alaska" ~ "Alaska South SE",
Region1Name == "L_Columbia_R_sp" ~ "Spring Cowlitz",
Region1Name == "Snake_R_sp/su" ~ "Snake Sp-Su",
Region1Name == "U_Columbia_R_su/fa" ~
"Up-Columbia S-F",
Region1Name == "Mid_and_Upper_Columbia_R_sp" ~
"Mid-Columbia Brights/Upriver Brights",
Region1Name == "Mid_Columbia_R_tule" ~
"Mid-Columbia Brights/Upriver Brights",
stock %in% c("SKAGIT_SU", "SKYKOMISH_SU") ~ "Puget Sound Summer",
stock == "NOOKSACK_SP@KE" ~ "Puget Sound Spring",
Region1Name == "N_Puget_Sound" ~ "North Puget Sound Fall",
Region1Name == "C_Puget_Sound" ~ "Central Puget Sound Fall",
Region1Name == "S_Puget_Sound" ~ "South Puget Sound Fall",
grepl("GOLD", stock) ~ "West Coast Hatchery",
grepl("TOQUA", stock) ~ "West Coast Hatchery",
Region1Name %in% c("CONUMA", "ROBERTSON", "NITINAT", "THORNTON") ~
"West Coast Hatchery",
Region1Name == "WCVI" ~ "West Coast Wild",
grepl("QUINS", stock) ~ "Upper Strait of Georgia",
grepl("NIMP", stock) ~ "North/Central BC",
Region1Name == "ECVI" ~
"Lower Strait of Georgia/Lower GS Hatchery",
stock %in% c("CAPILANO") ~ "SOMN",
stock %in% c("BUTE", "DEVEREUX", "HOMATHKO", "KLINAKLINI") ~
"Upper Strait of Georgia",
Region1Name == "SOMN" ~
"Lower Strait of Georgia/Lower GS Hatchery",
Region1Name %in% c("Mid_Oregon_Coast",
"N_California/S_Oregon_Coast",
"N_Oregon_Coast") ~
"Oregon Coastal North Migrating",
Region1Name == "Washington_Coast" ~
"Washington Coast/Juan de Fuca",
Region1Name == "Snake_R_fa" ~ "Snake Fall",
Region1Name %in% c("L_Columbia_R_fa", "Willamette_R") ~
"Fall Cowlitz/Willamette",
Region1Name %in% c("Central_Valley_sp",
"Klamath_R",
"California_Coast") ~ "California",
Region1Name == "Taku_R" ~ "Alaska South SE",
Region2Name == "Califormia" ~ "California",
Region2Name == " Up-Columbia S-F" ~ "Up-Columbia S-F",
Region1Name == "SOMN" ~ "Upper Strait of Georgia",
Region1Name == "NOMN" ~ "North/Central BC",
TRUE ~ as.character(Region2Name)
),
Region3Name =
case_when(
grepl("Puget", Region1Name) ~ "Puget Sound",
grepl("Oregon", Region1Name) ~ "Oregon/California",
Region1Name == "Washington_Coast" ~ "Washington Coast",
Region3Name == "Coastal Washington" ~ "Washington Coast",
grepl("NIMP", stock) ~ "North/Central BC",
Region1Name == "NOMN" ~ "North/Central BC",
Region1Name == "ECVI" ~ "SOG",
grepl("Fraser", Region1Name) ~ "Fraser River",
stock %in% c("CAPILANO") ~ "Fraser River",
grepl("CHEAK", stock) ~ "SOG",
Region1Name == "SOMN" ~ "SOG",
grepl("Snake", Region1Name) ~ "Snake",
grepl("Columbia", Region1Name) ~ "Columbia",
grepl("California", Region2Name) ~ "Oregon/California",
Region2Name == "Alaska South SE" ~ "Alaska South SE",
Region2Name == "North/Central BC" ~ "North/Central BC",
Region1Name == "Willamette_R" ~ "Columbia",
Region1Name == "WCVI" ~ "WCVI",
TRUE ~ as.character(Region3Name)
),
Region4Name =
case_when(
Region3Name %in% c("Washington Coast", "Oregon/California") ~
"CoastUS",
Region3Name %in% c("SOG", "Puget Sound", "Fraser River") ~
"SalSea",
Region3Name %in% c("Columbia", "Snake") ~ "ColR",
Region3Name == "North/Central BC" ~ "NBC",
Region3Name == "Alaska South SE" ~ "SEAK",
TRUE ~ Region3Name
)
) %>%
distinct() %>%
arrange(Region4Name, Region3Name, Region2Name, Region1Name, stock) %>%
#add PST aggregate names
mutate(pst_agg = case_when(
Region3Name == "Oregon/California" ~ "CA_ORCST",
Region3Name == "Washington Coast" ~ "WACST",
Region3Name == "Puget Sound" ~ "PSD",
Region3Name %in% c("Alaska South SE", "North/Central BC") ~ "NBC_SEAK",
Region1Name == "Fraser_Fall" ~ "FR-late",
Region3Name == "Fraser River" ~ "FR-early",
Region1Name %in% c("L_Columbia_R_fa") ~ "CR-tule",
Region1Name %in% c("L_Columbia_R_sp", "Snake_R_sp/su",
"Mid_and_Upper_Columbia_R_sp", "Willamette_R") ~
"CR-sp&su",
Region1Name %in% c("U_Columbia_R_su/fa", "Snake_R_fa",
"Mid_Columbia_R_tule") ~ "CR-bright",
TRUE ~ Region3Name
))
# checks
key_out %>%
select(stock, Region1Name, pst_agg) %>%
filter(is.na(pst_agg)) %>%
distinct()
key_out %>%
group_by(stock) %>%
filter(n()>1)  %>%
arrange(stock) %>%
select(stock, Region1Name)
cwt_out %>%
filter(stock == "SNAKE R")
cwt_out <- cwt %>%
mutate(
Region1Name = case_when(
grepl("COLE RIVERS", stock) ~ "Rogue_R",
grepl("COLUMBIA R UPRIVER S", stock) ~ "L_Columbia_R_sp",
grepl("WASHOUGAL", stock) ~ "L_Columbia_R_fa",
grepl("TANNER", stock) ~ "L_Columbia_R_fa",
stock == "COWLITZ R    26.0002" ~ "L_Columbia_R_fa",
stock == "SANDY HATCHERY (SANDY R)" ~ "L_Columbia_R_fa",
stock == "MINTER CR    15.0048" ~ "S_Puget_Sound",
grepl("WELLS HATCH", stock) ~ "U_Columbia_R_su/fa",
grepl("S-BEDWELL", stock) ~ "WCVI",
grepl("SKAGIT", stock) ~ "N_Puget_Sound",
grepl("WHITE", stock) ~ "C_Puget_Sound",
state == "AK" ~ "Alaska",
basin == "UPTR" ~ "Fraser_Summer_4.1",
basin == "SKNA" ~ "Skeena Bulkley",
basin %in% c("SWVI", "NWVI") ~ "WCVI",
rmis_region %in% c("SAFA", "CECA") ~ "Central_Valley_fa",
rmis_region == "KLTR" ~ "Klamath_R",
basin == "CLEA" ~ "Snake_R_fa",
stock == "LYONS FERRY HATCHERY" ~ "Snake_R_fa",
# rmis_region == "SNAK" ~ "Snake_R_sp/su",
basin %in% c("UPSN", "SALM", "SIYA") ~ "Snake_R_sp/su",
basin %in% c("DESC", "UMAT", "HOO", "KLIC", "CRGNG", "WAGN") ~
"U_Columbia_R_su/fa",
rmis_region == "UPCR" ~ "U_Columbia_R_su/fa",
basin %in% c("WILL", "YOCL") ~ "Willamette_R",
basin %in% c("SAND", "SAWA", "GREL") ~ "L_Columbia_R_fa",
basin %in% c("TILN", "NEHA") ~ "N_Oregon_Coast",
grepl("CLEAR CR", stock) ~ "S_Puget_Sound",
basin == "UMPQ" ~ "Mid_Oregon_Coast",
basin == "SIXE" ~ "N_California/S_Oregon_Coast",
basin == "ROGU" ~ "Rogue_R",
basin %in% c("LEWI", "WIND", "COWL") ~ "L_Columbia_R_sp",
basin == "GHLC" ~ "Washington_Coast",
rmis_region %in% c("WILP", "NWC") ~ "Washington_Coast",
rmis_region == "HOOD" ~ "Hood_Canal",
rmis_region == "JUAN" ~ "Juan_de_Fuca",
rmis_region == "MPS" ~ "C_Puget_Sound",
rmis_region %in% c("NPS", "NOWA", "SKAG") ~ "N_Puget_Sound",
rmis_region == "SPS" ~ "S_Puget_Sound",
TRUE ~ Region1Name
)#,
# snake run timing distinguished at basin level, adjust stock name
# accordingly
# stock = case_when(
#   basin == "CLEA" ~ "SNAKE R FALL"
# )
)
key2 <- rbind(key1,
cwt_out %>%
select(stock, Region1Name)) %>%
mutate(Region1Name = gsub(" ", "_", Region1Name))
key_out <- key2 %>%
left_join(.,
key_rts %>%
select(Region1Name, Region2Name, Region3Name) %>%
distinct(),
by = "Region1Name") %>%
distinct() %>%
mutate(
Region2Name =
case_when(
Region1Name %in% c("Nass", "Skeena_Lower", "Skeena_Bulkley",
"Skeena_Mid", "Skeena_Upper", "Skeena_Babine",
"Alsek") ~ "North/Central BC",
grepl("Fraser_Spring", Region1Name) ~ "Fraser Early",
grepl("Fraser_Summer", Region1Name) ~ "Fraser Early",
grepl("Fraser_Fall", Region1Name) ~ "Fraser Late",
Region1Name == "Juan_de_Fuca" ~ "Washington Coast/Juan de Fuca",
Region1Name == "Hood_Canal" ~ "Hood Canal",
Region1Name == "Central_Valley_fa" ~ "California",
Region1Name == "Alaska" ~ "Alaska South SE",
Region1Name == "L_Columbia_R_sp" ~ "Spring Cowlitz",
Region1Name == "Snake_R_sp/su" ~ "Snake Sp-Su",
Region1Name == "U_Columbia_R_su/fa" ~
"Up-Columbia S-F",
Region1Name == "Mid_and_Upper_Columbia_R_sp" ~
"Mid-Columbia Brights/Upriver Brights",
Region1Name == "Mid_Columbia_R_tule" ~
"Mid-Columbia Brights/Upriver Brights",
stock %in% c("SKAGIT_SU", "SKYKOMISH_SU") ~ "Puget Sound Summer",
stock == "NOOKSACK_SP@KE" ~ "Puget Sound Spring",
Region1Name == "N_Puget_Sound" ~ "North Puget Sound Fall",
Region1Name == "C_Puget_Sound" ~ "Central Puget Sound Fall",
Region1Name == "S_Puget_Sound" ~ "South Puget Sound Fall",
grepl("GOLD", stock) ~ "West Coast Hatchery",
grepl("TOQUA", stock) ~ "West Coast Hatchery",
Region1Name %in% c("CONUMA", "ROBERTSON", "NITINAT", "THORNTON") ~
"West Coast Hatchery",
Region1Name == "WCVI" ~ "West Coast Wild",
grepl("QUINS", stock) ~ "Upper Strait of Georgia",
grepl("NIMP", stock) ~ "North/Central BC",
Region1Name == "ECVI" ~
"Lower Strait of Georgia/Lower GS Hatchery",
stock %in% c("CAPILANO") ~ "SOMN",
stock %in% c("BUTE", "DEVEREUX", "HOMATHKO", "KLINAKLINI") ~
"Upper Strait of Georgia",
Region1Name == "SOMN" ~
"Lower Strait of Georgia/Lower GS Hatchery",
Region1Name %in% c("Mid_Oregon_Coast",
"N_California/S_Oregon_Coast",
"N_Oregon_Coast") ~
"Oregon Coastal North Migrating",
Region1Name == "Washington_Coast" ~
"Washington Coast/Juan de Fuca",
Region1Name == "Snake_R_fa" ~ "Snake Fall",
Region1Name %in% c("L_Columbia_R_fa", "Willamette_R") ~
"Fall Cowlitz/Willamette",
Region1Name %in% c("Central_Valley_sp",
"Klamath_R",
"California_Coast") ~ "California",
Region1Name == "Taku_R" ~ "Alaska South SE",
Region2Name == "Califormia" ~ "California",
Region2Name == " Up-Columbia S-F" ~ "Up-Columbia S-F",
Region1Name == "SOMN" ~ "Upper Strait of Georgia",
Region1Name == "NOMN" ~ "North/Central BC",
TRUE ~ as.character(Region2Name)
),
Region3Name =
case_when(
grepl("Puget", Region1Name) ~ "Puget Sound",
grepl("Oregon", Region1Name) ~ "Oregon/California",
Region1Name == "Washington_Coast" ~ "Washington Coast",
Region3Name == "Coastal Washington" ~ "Washington Coast",
grepl("NIMP", stock) ~ "North/Central BC",
Region1Name == "NOMN" ~ "North/Central BC",
Region1Name == "ECVI" ~ "SOG",
grepl("Fraser", Region1Name) ~ "Fraser River",
stock %in% c("CAPILANO") ~ "Fraser River",
grepl("CHEAK", stock) ~ "SOG",
Region1Name == "SOMN" ~ "SOG",
grepl("Snake", Region1Name) ~ "Snake",
grepl("Columbia", Region1Name) ~ "Columbia",
grepl("California", Region2Name) ~ "Oregon/California",
Region2Name == "Alaska South SE" ~ "Alaska South SE",
Region2Name == "North/Central BC" ~ "North/Central BC",
Region1Name == "Willamette_R" ~ "Columbia",
Region1Name == "WCVI" ~ "WCVI",
TRUE ~ as.character(Region3Name)
),
Region4Name =
case_when(
Region3Name %in% c("Washington Coast", "Oregon/California") ~
"CoastUS",
Region3Name %in% c("SOG", "Puget Sound", "Fraser River") ~
"SalSea",
Region3Name %in% c("Columbia", "Snake") ~ "ColR",
Region3Name == "North/Central BC" ~ "NBC",
Region3Name == "Alaska South SE" ~ "SEAK",
TRUE ~ Region3Name
)
) %>%
distinct() %>%
arrange(Region4Name, Region3Name, Region2Name, Region1Name, stock) %>%
#add PST aggregate names
mutate(pst_agg = case_when(
Region3Name == "Oregon/California" ~ "CA_ORCST",
Region3Name == "Washington Coast" ~ "WACST",
Region3Name == "Puget Sound" ~ "PSD",
Region3Name %in% c("Alaska South SE", "North/Central BC") ~ "NBC_SEAK",
Region1Name == "Fraser_Fall" ~ "FR-late",
Region3Name == "Fraser River" ~ "FR-early",
Region1Name %in% c("L_Columbia_R_fa") ~ "CR-tule",
Region1Name %in% c("L_Columbia_R_sp", "Snake_R_sp/su",
"Mid_and_Upper_Columbia_R_sp", "Willamette_R") ~
"CR-sp&su",
Region1Name %in% c("U_Columbia_R_su/fa", "Snake_R_fa",
"Mid_Columbia_R_tule") ~ "CR-bright",
TRUE ~ Region3Name
))
# checks
key_out %>%
select(stock, Region1Name, pst_agg) %>%
filter(is.na(pst_agg)) %>%
distinct()
key_out %>%
group_by(stock) %>%
filter(n()>1)  %>%
arrange(stock) %>%
select(stock, Region1Name)
cwt_out %>%
filter(grepl("SNAKE", stock))
cwt_out <- cwt %>%
mutate(
Region1Name = case_when(
grepl("COLE RIVERS", stock) ~ "Rogue_R",
grepl("COLUMBIA R UPRIVER S", stock) ~ "L_Columbia_R_sp",
grepl("WASHOUGAL", stock) ~ "L_Columbia_R_fa",
grepl("TANNER", stock) ~ "L_Columbia_R_fa",
stock == "COWLITZ R    26.0002" ~ "L_Columbia_R_fa",
stock == "SANDY HATCHERY (SANDY R)" ~ "L_Columbia_R_fa",
stock == "MINTER CR    15.0048" ~ "S_Puget_Sound",
grepl("WELLS HATCH", stock) ~ "U_Columbia_R_su/fa",
grepl("S-BEDWELL", stock) ~ "WCVI",
grepl("SKAGIT", stock) ~ "N_Puget_Sound",
grepl("WHITE", stock) ~ "C_Puget_Sound",
state == "AK" ~ "Alaska",
basin == "UPTR" ~ "Fraser_Summer_4.1",
basin == "SKNA" ~ "Skeena Bulkley",
basin %in% c("SWVI", "NWVI") ~ "WCVI",
rmis_region %in% c("SAFA", "CECA") ~ "Central_Valley_fa",
rmis_region == "KLTR" ~ "Klamath_R",
basin == "CLEA" ~ "Snake_R_fa",
stock == "LYONS FERRY HATCHERY" ~ "Snake_R_fa",
basin %in% c("UPSN", "SALM", "SIYA") ~ "Snake_R_sp/su",
basin %in% c("DESC", "UMAT", "HOO", "KLIC", "CRGNG", "WAGN") ~
"U_Columbia_R_su/fa",
rmis_region == "UPCR" ~ "U_Columbia_R_su/fa",
basin %in% c("WILL", "YOCL") ~ "Willamette_R",
basin %in% c("SAND", "SAWA", "GREL") ~ "L_Columbia_R_fa",
basin %in% c("TILN", "NEHA") ~ "N_Oregon_Coast",
grepl("CLEAR CR", stock) ~ "S_Puget_Sound",
basin == "UMPQ" ~ "Mid_Oregon_Coast",
basin == "SIXE" ~ "N_California/S_Oregon_Coast",
basin == "ROGU" ~ "Rogue_R",
basin %in% c("LEWI", "WIND", "COWL") ~ "L_Columbia_R_sp",
basin == "GHLC" ~ "Washington_Coast",
rmis_region == "SNAK" ~ "Snake_R_sp/su",
rmis_region %in% c("WILP", "NWC") ~ "Washington_Coast",
rmis_region == "HOOD" ~ "Hood_Canal",
rmis_region == "JUAN" ~ "Juan_de_Fuca",
rmis_region == "MPS" ~ "C_Puget_Sound",
rmis_region %in% c("NPS", "NOWA", "SKAG") ~ "N_Puget_Sound",
rmis_region == "SPS" ~ "S_Puget_Sound",
TRUE ~ Region1Name
),
# snake run timing distinguished at basin level, adjust stock name
# accordingly
stock = case_when(
basin == "CLEA" ~ "SNAKE R FALL",
TRUE ~ stock
)
)
key2 <- rbind(key1,
cwt_out %>%
select(stock, Region1Name)) %>%
mutate(Region1Name = gsub(" ", "_", Region1Name))
key_out <- key2 %>%
left_join(.,
key_rts %>%
select(Region1Name, Region2Name, Region3Name) %>%
distinct(),
by = "Region1Name") %>%
distinct() %>%
mutate(
Region2Name =
case_when(
Region1Name %in% c("Nass", "Skeena_Lower", "Skeena_Bulkley",
"Skeena_Mid", "Skeena_Upper", "Skeena_Babine",
"Alsek") ~ "North/Central BC",
grepl("Fraser_Spring", Region1Name) ~ "Fraser Early",
grepl("Fraser_Summer", Region1Name) ~ "Fraser Early",
grepl("Fraser_Fall", Region1Name) ~ "Fraser Late",
Region1Name == "Juan_de_Fuca" ~ "Washington Coast/Juan de Fuca",
Region1Name == "Hood_Canal" ~ "Hood Canal",
Region1Name == "Central_Valley_fa" ~ "California",
Region1Name == "Alaska" ~ "Alaska South SE",
Region1Name == "L_Columbia_R_sp" ~ "Spring Cowlitz",
Region1Name == "Snake_R_sp/su" ~ "Snake Sp-Su",
Region1Name == "U_Columbia_R_su/fa" ~
"Up-Columbia S-F",
Region1Name == "Mid_and_Upper_Columbia_R_sp" ~
"Mid-Columbia Brights/Upriver Brights",
Region1Name == "Mid_Columbia_R_tule" ~
"Mid-Columbia Brights/Upriver Brights",
stock %in% c("SKAGIT_SU", "SKYKOMISH_SU") ~ "Puget Sound Summer",
stock == "NOOKSACK_SP@KE" ~ "Puget Sound Spring",
Region1Name == "N_Puget_Sound" ~ "North Puget Sound Fall",
Region1Name == "C_Puget_Sound" ~ "Central Puget Sound Fall",
Region1Name == "S_Puget_Sound" ~ "South Puget Sound Fall",
grepl("GOLD", stock) ~ "West Coast Hatchery",
grepl("TOQUA", stock) ~ "West Coast Hatchery",
Region1Name %in% c("CONUMA", "ROBERTSON", "NITINAT", "THORNTON") ~
"West Coast Hatchery",
Region1Name == "WCVI" ~ "West Coast Wild",
grepl("QUINS", stock) ~ "Upper Strait of Georgia",
grepl("NIMP", stock) ~ "North/Central BC",
Region1Name == "ECVI" ~
"Lower Strait of Georgia/Lower GS Hatchery",
stock %in% c("CAPILANO") ~ "SOMN",
stock %in% c("BUTE", "DEVEREUX", "HOMATHKO", "KLINAKLINI") ~
"Upper Strait of Georgia",
Region1Name == "SOMN" ~
"Lower Strait of Georgia/Lower GS Hatchery",
Region1Name %in% c("Mid_Oregon_Coast",
"N_California/S_Oregon_Coast",
"N_Oregon_Coast") ~
"Oregon Coastal North Migrating",
Region1Name == "Washington_Coast" ~
"Washington Coast/Juan de Fuca",
Region1Name == "Snake_R_fa" ~ "Snake Fall",
Region1Name %in% c("L_Columbia_R_fa", "Willamette_R") ~
"Fall Cowlitz/Willamette",
Region1Name %in% c("Central_Valley_sp",
"Klamath_R",
"California_Coast") ~ "California",
Region1Name == "Taku_R" ~ "Alaska South SE",
Region2Name == "Califormia" ~ "California",
Region2Name == " Up-Columbia S-F" ~ "Up-Columbia S-F",
Region1Name == "SOMN" ~ "Upper Strait of Georgia",
Region1Name == "NOMN" ~ "North/Central BC",
TRUE ~ as.character(Region2Name)
),
Region3Name =
case_when(
grepl("Puget", Region1Name) ~ "Puget Sound",
grepl("Oregon", Region1Name) ~ "Oregon/California",
Region1Name == "Washington_Coast" ~ "Washington Coast",
Region3Name == "Coastal Washington" ~ "Washington Coast",
grepl("NIMP", stock) ~ "North/Central BC",
Region1Name == "NOMN" ~ "North/Central BC",
Region1Name == "ECVI" ~ "SOG",
grepl("Fraser", Region1Name) ~ "Fraser River",
stock %in% c("CAPILANO") ~ "Fraser River",
grepl("CHEAK", stock) ~ "SOG",
Region1Name == "SOMN" ~ "SOG",
grepl("Snake", Region1Name) ~ "Snake",
grepl("Columbia", Region1Name) ~ "Columbia",
grepl("California", Region2Name) ~ "Oregon/California",
Region2Name == "Alaska South SE" ~ "Alaska South SE",
Region2Name == "North/Central BC" ~ "North/Central BC",
Region1Name == "Willamette_R" ~ "Columbia",
Region1Name == "WCVI" ~ "WCVI",
TRUE ~ as.character(Region3Name)
),
Region4Name =
case_when(
Region3Name %in% c("Washington Coast", "Oregon/California") ~
"CoastUS",
Region3Name %in% c("SOG", "Puget Sound", "Fraser River") ~
"SalSea",
Region3Name %in% c("Columbia", "Snake") ~ "ColR",
Region3Name == "North/Central BC" ~ "NBC",
Region3Name == "Alaska South SE" ~ "SEAK",
TRUE ~ Region3Name
)
) %>%
distinct() %>%
arrange(Region4Name, Region3Name, Region2Name, Region1Name, stock) %>%
#add PST aggregate names
mutate(pst_agg = case_when(
Region3Name == "Oregon/California" ~ "CA_ORCST",
Region3Name == "Washington Coast" ~ "WACST",
Region3Name == "Puget Sound" ~ "PSD",
Region3Name %in% c("Alaska South SE", "North/Central BC") ~ "NBC_SEAK",
Region1Name == "Fraser_Fall" ~ "FR-late",
Region3Name == "Fraser River" ~ "FR-early",
Region1Name %in% c("L_Columbia_R_fa") ~ "CR-tule",
Region1Name %in% c("L_Columbia_R_sp", "Snake_R_sp/su",
"Mid_and_Upper_Columbia_R_sp", "Willamette_R") ~
"CR-sp&su",
Region1Name %in% c("U_Columbia_R_su/fa", "Snake_R_fa",
"Mid_Columbia_R_tule") ~ "CR-bright",
TRUE ~ Region3Name
))
key_out %>%
group_by(stock) %>%
filter(n()>1)  %>%
arrange(stock) %>%
select(stock, Region1Name)
# save
saveRDS(key_out, here::here("data", "generated", "finalStockList_June2020.rds"))
write.csv(key_out, here::here("data", "generated", "finalStockList_June2020.csv"),
row.names = FALSE)
glimpse(key_out)
